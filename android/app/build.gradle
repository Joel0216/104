plugins {
    id "com.android.application"
    id "org.jetbrains.kotlin.android"
    // Plugin declarativo de Flutter
    id "dev.flutter.flutter-gradle-plugin"
}

// Variables que usa Flutter para versionado (si no vienen por línea de comando)
def flutterVersionCode = project.hasProperty('flutterVersionCode') ? project.flutterVersionCode : '1'
def flutterVersionName = project.hasProperty('flutterVersionName') ? project.flutterVersionName : '1.0'

android {
    // Debe coincidir con tu paquete real
    namespace "com.example.shrine"

    compileSdkVersion 34

    defaultConfig {
        applicationId "com.example.shrine"
        minSdkVersion flutter.minSdkVersion
        targetSdkVersion 34

        versionCode flutterVersionCode.toInteger()
        versionName flutterVersionName
    }

    buildTypes {
        release {
            // Mantengo simple; si ya usas keystore propio, reemplaza esta línea
            signingConfig signingConfigs.debug
            minifyEnabled false
            shrinkResources false
        }
        debug {
            debuggable true
        }
        profile {
            debuggable true
        }
    }

    // AGP 8.x / Gradle 8.7 → Java/Kotlin 17+
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_17
        targetCompatibility JavaVersion.VERSION_17
    }
    kotlinOptions {
        jvmTarget = "17"
    }

    // (Opcional) si tu proyecto tiene libs nativas antiguas
    packagingOptions {
        jniLibs {
            useLegacyPackaging = true
        }
    }
}

// Con el nuevo plugin no es obligatorio el bloque flutter{}
// Deja vacío salvo que tengas dependencias Android puras extras
dependencies {
}
